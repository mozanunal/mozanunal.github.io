<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=description content="An example site for the clean and configurable Hugo Classless theme."><link href=/2015/05/arduino-due-osiloskop/ rel=alternate type=application/rss+xml title=mozanunal.com><link id=theme-style rel=stylesheet href=/css/classless.20c8e211f6768ba295effc3e101a31bfe248db7295bb122355bdf893c6cee731.css integrity="sha256-IMjiEfZ2i6KV7/w+EBoxv+JI23KVuxIjVb34k8bO5zE="><style>pre code,code{-webkit-text-size-adjust:100%;text-size-adjust:100%}img{display:block;margin-left:auto;margin-right:auto}figcaption{display:block;margin-left:auto;margin-right:auto}nav{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;overflow:visible;font-size:1.4rem}nav ul{display:flex;list-style:none;padding:0;margin:0;gap:.5rem}</style><link rel=stylesheet href=/css/syntax-light.min.d1e9974bf1fe0f3bfae6a7af3a04c1e749276b8efbbf6d3397998585f82443f0.css media="(prefers-color-scheme: light)"><link rel=stylesheet href=/css/syntax-dark.min.22964c63865be9217cedda7ac3dbd0143f8f41b3a0f681ef71e845b18a33a4f3.css media="(prefers-color-scheme: dark)"><title>[TR] Arduino Due Osiloskop | mozanunal.com</title><link rel=icon href=/favicon.svg type=image/svg+xml><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body><header><nav><ul><li><strong>mozanunal.com</strong></li></ul><ul><li><a href=/>Home</a></li><li><a href=/posts/>Posts</a></li><li><a href=/projects/>Projects</a></li><li><a href=/papers/>Papers</a></li><li><a href=/contact/>Contact</a></li></ul></nav></header><main><article><h1>[TR] Arduino Due Osiloskop</h1><p><em>May 2, 2015</em></p><div><p><strong>Merhaba Arkadaşlar,</strong></p><p>Bugün size Arduino Due ile yaptığım osiloskop bahsedeceğim. Arduino Dueyi
seçmemin bir kaç nedeni var tabi. Arduino Duede standart Arduinoların 8 bitlik
Atmega işlemcilerinden farklı olarak 32 bitlik Arm Cortex M3 var. Bu işlemcinin
84 Mhzlik saat hızı bu proje için elverişli kılıyor.</p><p>Osiloskop projesine başlarken amacım Due ile mümkün olan en yüksek örnekleme
hızlı osiloskobu yapmaktı. İlk olarak arduinonun standart AnalogRead()
fonksiyonunu denedim. Bir örnek alma süresi 40 uS kadar sürdü. Daha sonra
<a href=https://frenki.net/2013/10/fast-analogread-with-arduino-due/>bu bağlantıyı</a>
buldum ve oradaki ayarları Duenin ADCsine uyguladım. Osiloskobun son kodu
aşağıdaki gibidir. Bu kod sayesinde ADClere direk registerlar.</p><p>üzerinden ulaşıyoruz. Arduinonun fonksiyonunda her analog değer alma işleminde
ilkönce ADC&rsquo;yi açıyor, okuduktan sonra ise kapatıyor. Bu kodda ise ADCyi FREE
RUN modunda kullanmış oluyoruz. Bu sayede bir örnekleme ortalama 1 uS sürüyor
yani 1 Mega Sample Per Second (MSa/s) bir osiloskop yapmış olduk.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>start_time</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>stop_time</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>values</span><span class=p>[</span><span class=mi>1000</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>        
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=mi>9600</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>ADC</span><span class=o>-&gt;</span><span class=n>ADC_MR</span> <span class=o>|=</span> <span class=mh>0x80</span><span class=p>;</span>  <span class=c1>//FREE RUN Adc moda geçilir.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>ADC</span><span class=o>-&gt;</span><span class=n>ADC_CHER</span> <span class=o>=</span> <span class=mh>0x80</span><span class=p>;</span> <span class=c1>//A0 pinini enable yap
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=n>start_time</span> <span class=o>=</span> <span class=n>micros</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=mi>1000</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>((</span><span class=n>ADC</span><span class=o>-&gt;</span><span class=n>ADC_ISR</span> <span class=o>&amp;</span> <span class=mh>0x80</span><span class=p>)</span><span class=o>==</span><span class=mi>0</span><span class=p>);</span> <span class=c1>// örnekleme yapılana kadar bekle
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>=</span><span class=n>ADC</span><span class=o>-&gt;</span><span class=n>ADC_CDR</span><span class=p>[</span><span class=mi>7</span><span class=p>];</span> <span class=c1>//değeri al
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>stop_time</span> <span class=o>=</span> <span class=n>micros</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Total time: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>stop_time</span><span class=o>-</span><span class=n>start_time</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Average time per conversion: &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>((</span><span class=kt>float</span><span class=p>)(</span><span class=n>stop_time</span><span class=o>-</span><span class=n>start_time</span><span class=p>)</span><span class=o>/</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;$, &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=mi>1000</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>values</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;,&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>2000</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Osiloskop arayüzünü ise C# dilini kullanarak yazdım. Osiloskop için kullunanılan
<a href=https://www.oscilloscope-lib.com/>bu kütüphaneyi</a> kullandım. Arayüzden
görüntüler de aşağıdadır.</p><p><strong>Osilopkop denemeleri</strong></p><p><img src=Ekran%2BAl%C4%B1nt%C4%B1s%C4%B1.png alt></p><p><strong>Com port seçiminin yapıldığı pencere</strong></p><p><img src=Ekran%2BAl%C4%B1nt%C4%B1s%C4%B12.png alt></p></div></article></main><footer><p>&copy; 2025 M.Ozan Unal.</p></footer></body><link rel=stylesheet href=/libs/katex/katex.min.v0.16.9.css><script defer src=/libs/katex/katex.min.v0.16.9.js></script><script defer src=/libs/katex/auto-render.v0.16.9.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-007KSW65JL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-007KSW65JL")}</script></html>