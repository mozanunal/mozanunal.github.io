<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><link id=theme-style rel=stylesheet href=https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.classless.min.css><title>[TR] Arduino Gimbal Kontrol Kartı | mozanunal.com</title><link rel=icon href=/favicon.svg type=image/svg+xml><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body><header><div class=theme-selector><select id=theme-selector-input><option value=https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.classless.min.css>Pico</option><option value=https://cdn.jsdelivr.net/gh/digitallytailored/classless@latest/classless.min.css>Classless.css</option><option value=https://cdn.jsdelivr.net/gh/cspablocortez/cosmocss@latest/cosmo.min.css>Cosmo.css</option><option value=https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.min.css>Pico-Fluid</option><option value=https://cdn.jsdelivr.net/npm/water.css@2/out/water.css>Water.css</option><option value=https://cdn.jsdelivr.net/npm/sakura.css/css/sakura.css>Sakura.css</option><option value=https://cdn.simplecss.org/simple.min.css>Simple.css</option><option value=https://cdn.jsdelivr.net/gh/alvaromontoro/almond.css@latest/dist/almond.min.css>Almond.css</option><option value=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css>New.css</option><option value=https://unpkg.com/missing.css>Missing.css</option><option value=https://unpkg.com/boltcss/bolt.min.css>Bolt.css</option><option value=https://perfectmotherfuckingwebsite.com/fuckingstyle.css>PerfectMFWS</option><option value>HTML only</option></select></div><script>(function(){"use strict";const o=document.getElementById("theme-style"),e=document.getElementById("theme-selector-input"),n="hugo-classless-theme";function s(t){o.href=t,e&&(e.value=t)}const t=localStorage.getItem(n);if(t){const n=Array.from(e.options).some(e=>e.value===t);n&&s(t)}e&&e.addEventListener("change",()=>{const t=e.value;s(t),localStorage.setItem(n,t)})})()</script><div><h3>mozanunal.com</h3><h4><a href=/>Home</a> | <a href=/posts/>Posts</a> | <a href=/projects/>Projects</a> | <a href=/papers/>Papers</a> | <a href=/contact/>Contact</a></h4></div></header><main><article><header><h1>[TR] Arduino Gimbal Kontrol Kartı</h1><p><em><time datetime=2015-07-04>July 4, 2015</time></em></p></header><div><p><strong>Herkese Merhabalar,</strong></p><p>Daha önce kolay bulunabilecek malzemelerden nasıl gimbal yapılabileceğinden
bahsetmiştim
(<a href=https://mozanunal.com/2015/06/2-eksenli-servo-gimbal-yapm/>O yazıya buradan ulaşabiliriniz</a>).
Kontrol kartını sonra anlatacağım demiştim. Veee bu yazımda arduino ve MPU6050
sensörü kullanarak nasıl bir gimbal kontrol kartı yapabileceğimizden
bahsedeceğim. Bu kart sayesinde gimbalin yere göre açısını kontrol edebileceğiz.
Yere göre açısının sabit kalmasını da kontrol kartı üzerindeki IMU sensörü ile
sağlayacağız(<a href=https://mozanunal.com/2014/11/imu-aclarnn-3-boyutlu-olarak/>Ayrıntılı bilgi için tıklayınız</a>).
Kontrol kartı saniyede 100 değer okuyup servo PWM değerlerini ona göre
güncelliyor. Bu sayede oldukça yüksek çözünürlüklü her türlü seviyede
kullanılabilecek bir kontrol kartı yapmış oluyoruz. Ayrıca başa koyduğum ayar
parametreleri sayesinde her boyutta ve çeşitte servo gimbale kolayca uyumlu hale
getirilebilir. Kontrol kartının tanıtım videosu aşağıdadır.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/MnfJcTREYPo?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>Bağlantılara gelecek olursak MPU6050 I2C pinlerinden arduinoya bağlanıyor. Gnd
pini gndye, Vcc pini ise 3.3 volta bağlanıyor. Çalışma voltajı 3.3 volt olduğu
için. Servoların sinyal pinlerini ayarlardan seçtiğimiz dijital pinlere
bağlıyoruz. Servoların beslemesi eğer küçük servolar ise arduino üzerinden eğer
yüksek akım çeken servolarsa harici olarak yapabilirsiniz. Fakat harici besleme
yaparsanız arduino ve güç kaynağının topraklarını eşitlemeyi unutmayın.</p><div class=highlight><pre tabindex=0 style=color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#737994;font-style:italic>////////////////////Ayarlar////////////////  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>//pitch  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span><span style=color:#e78284>int</span> p_pin<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>8</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_neturalpos<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>90</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_gain<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>1</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_min<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>30</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_max<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>150</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_reverse<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>0</span>;  
</span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>//roll  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span><span style=color:#e78284>int</span> r_pin<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>9</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_neturalpos<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>90</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_gain<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>1</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_min<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>30</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_max<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>150</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_reverse<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>0</span>;  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>///////////////////////////////////////////////
</span></span></span></code></pre></div><p>Bunlar, koddaki ayar parametreleri, çeşitli gimballere kolay adapte edilebilmesi
içindir. İlk pozisyonunu, en düşük, en yüksek servo açılarını, kazancını bu
parametrelerle kontrol edeceğiz. Kazanç ise kontrol kartındaki açı
değişimlerinin servoya kaçla çarpılarak yansıtılacağının
parametresidir.&ldquo;Reverse&rdquo; değişkeni &ldquo;1&rdquo; veya &ldquo;0&rdquo; yapılarak yönün ters çevirilmesi
sağlanabilir. Benim gimbalim için &ldquo;Pitch&rdquo; eksenini ters yapmam gerekmişti.</p><p><strong>Sistemin Fotoğrafları</strong></p><p><img src=https://2.bp.blogspot.com/-tPAYzOfRh8Y/VZbhzOoEt3I/AAAAAAAAMsw/lg5YNJs2Gl4/s720/IMG_20150703_170713.jpg alt></p><p><img src=https://4.bp.blogspot.com/-SGgaLhyZB5o/VZbhyrpIPvI/AAAAAAAAMss/fUO7DeUM9gA/s720/IMG_20150703_170813.jpg alt></p><p><strong>Projenin full kaynak kodu:</strong></p><div class=highlight><pre tabindex=0 style=color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&lt;I2Cdev.h&gt;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&lt;MPU60X0.h&gt;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&lt;EEPROM.h&gt;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&#34;DebugUtils.h&#34;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&#34;CommunicationUtils.h&#34;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&#34;FreeIMU.h&#34;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&lt;Wire.h&gt;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&lt;SPI.h&gt;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>#include</span> <span style=color:#737994;font-weight:700;font-style:italic>&lt;Servo.h&gt;</span><span style=color:#737994;font-style:italic>  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span><span style=color:#737994;font-style:italic>////////////////////Ayarlar////////////////  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>//pitch  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span><span style=color:#e78284>int</span> p_pin<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>8</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_neturalpos<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>90</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_gain<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>1</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_min<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>30</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_max<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>150</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_reverse<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>0</span>;  
</span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>//roll  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span><span style=color:#e78284>int</span> r_pin<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>9</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_neturalpos<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>90</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_gain<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>1</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_min<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>30</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_max<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>150</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_reverse<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>0</span>;  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#737994;font-style:italic>///////////////////////////////////////////////  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span>Servo pitchservo;  
</span></span><span style=display:flex><span>Servo rollservo;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> p_angle<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>90</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> r_angle<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>90</span>;  
</span></span><span style=display:flex><span><span style=color:#e78284>int</span> raw_values[<span style=color:#ef9f76>9</span>];  
</span></span><span style=display:flex><span><span style=color:#e78284>float</span> ypr[<span style=color:#ef9f76>3</span>]; <span style=color:#737994;font-style:italic>// yaw pitch roll  
</span></span></span><span style=display:flex><span><span style=color:#737994;font-style:italic></span><span style=color:#e78284>float</span> val[<span style=color:#ef9f76>9</span>];  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FreeIMU my3IMU <span style=color:#99d1db;font-weight:700>=</span> FreeIMU();  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e78284>void</span> <span style=color:#8caaee>setup</span>() {  
</span></span><span style=display:flex><span>  Serial.begin(<span style=color:#ef9f76>115200</span>);  
</span></span><span style=display:flex><span>  pitchservo.attach(p_pin);  
</span></span><span style=display:flex><span>  rollservo.attach(r_pin);  
</span></span><span style=display:flex><span>  Wire.begin();  
</span></span><span style=display:flex><span>  delay(<span style=color:#ef9f76>5</span>);  
</span></span><span style=display:flex><span>  my3IMU.init();  
</span></span><span style=display:flex><span>  delay(<span style=color:#ef9f76>5</span>);  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e78284>void</span> <span style=color:#8caaee>loop</span>() {  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  my3IMU.getYawPitchRoll(ypr);  
</span></span><span style=display:flex><span>  Serial.print(<span style=color:#a6d189>&#34;Yaw: &#34;</span>);  
</span></span><span style=display:flex><span>  Serial.print(ypr[<span style=color:#ef9f76>0</span>]);  
</span></span><span style=display:flex><span>  Serial.print(<span style=color:#a6d189>&#34; Pitch: &#34;</span>);  
</span></span><span style=display:flex><span>  Serial.print(ypr[<span style=color:#ef9f76>1</span>]);  
</span></span><span style=display:flex><span>  Serial.print(<span style=color:#a6d189>&#34; Roll: &#34;</span>);  
</span></span><span style=display:flex><span>  Serial.print(ypr[<span style=color:#ef9f76>2</span>]);  
</span></span><span style=display:flex><span>  Serial.println(<span style=color:#a6d189>&#34;&#34;</span>);  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  p_angle<span style=color:#99d1db;font-weight:700>=</span>p_neturalpos<span style=color:#99d1db;font-weight:700>+</span>ypr[<span style=color:#ef9f76>1</span>]<span style=color:#99d1db;font-weight:700>*</span>p_gain;  
</span></span><span style=display:flex><span>  <span style=color:#ca9ee6>if</span>(p_angle<span style=color:#99d1db;font-weight:700>&gt;</span>p_max){  
</span></span><span style=display:flex><span>    p_angle<span style=color:#99d1db;font-weight:700>=</span>p_max;  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  <span style=color:#ca9ee6>if</span>(p_angle<span style=color:#99d1db;font-weight:700>&lt;</span>p_min){  
</span></span><span style=display:flex><span>    p_angle<span style=color:#99d1db;font-weight:700>=</span>p_min;  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  <span style=color:#ca9ee6>if</span>(p_reverse<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>1</span>){  
</span></span><span style=display:flex><span>    p_angle<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>180</span><span style=color:#99d1db;font-weight:700>-</span>p_angle;  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  pitchservo.write(p_angle);  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  r_angle<span style=color:#99d1db;font-weight:700>=</span>r_neturalpos<span style=color:#99d1db;font-weight:700>+</span>ypr[<span style=color:#ef9f76>2</span>]<span style=color:#99d1db;font-weight:700>*</span>r_gain;  
</span></span><span style=display:flex><span>  <span style=color:#ca9ee6>if</span>(r_angle<span style=color:#99d1db;font-weight:700>&gt;</span>r_max){  
</span></span><span style=display:flex><span>    r_angle<span style=color:#99d1db;font-weight:700>=</span>r_max;  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  <span style=color:#ca9ee6>if</span>(r_angle<span style=color:#99d1db;font-weight:700>&lt;</span>r_min){  
</span></span><span style=display:flex><span>    r_angle<span style=color:#99d1db;font-weight:700>=</span>r_min;  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  <span style=color:#ca9ee6>if</span>(r_reverse<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>1</span>){  
</span></span><span style=display:flex><span>    r_angle<span style=color:#99d1db;font-weight:700>=</span><span style=color:#ef9f76>180</span><span style=color:#99d1db;font-weight:700>-</span>r_angle;  
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  rollservo.write(r_angle);  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  delay(<span style=color:#ef9f76>10</span>);  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></article></main><footer><p>&copy; 2025 M.Ozan Unal.</p></footer></body><script async src="https://www.googletagmanager.com/gtag/js?id=G-007KSW65JL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-007KSW65JL")}</script></html>