<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=description content="An example site for the clean and configurable Hugo Classless theme."><link href=/2015/07/arduino-gimbal-kontrol-kart/ rel=alternate type=application/rss+xml title=mozanunal.com><link id=theme-style rel=stylesheet href=/css/classless.20c8e211f6768ba295effc3e101a31bfe248db7295bb122355bdf893c6cee731.css integrity="sha256-IMjiEfZ2i6KV7/w+EBoxv+JI23KVuxIjVb34k8bO5zE="><style>pre code,code{-webkit-text-size-adjust:100%;text-size-adjust:100%}img{display:block;margin-left:auto;margin-right:auto}figcaption{display:block;margin-left:auto;margin-right:auto}</style><link rel=stylesheet href=/css/syntax-light.min.d1e9974bf1fe0f3bfae6a7af3a04c1e749276b8efbbf6d3397998585f82443f0.css media="(prefers-color-scheme: light)"><link rel=stylesheet href=/css/syntax-dark.min.22964c63865be9217cedda7ac3dbd0143f8f41b3a0f681ef71e845b18a33a4f3.css media="(prefers-color-scheme: dark)"><title>[TR] Arduino Gimbal Kontrol Kartı | mozanunal.com</title><link rel=icon href=/favicon.svg type=image/svg+xml><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body><header><div><h1>mozanunal.com</h1><nav><h4><a href=/>Home</a> | <a href=/posts/>Posts</a> | <a href=/projects/>Projects</a> | <a href=/papers/>Papers</a> | <a href=/contact/>Contact</a></h4></nav></div></header><main><article><header><h1>[TR] Arduino Gimbal Kontrol Kartı</h1><p><em><time datetime=2015-07-04>July 4, 2015</time></em></p></header><div><p><strong>Herkese Merhabalar,</strong></p><p>Daha önce kolay bulunabilecek malzemelerden nasıl gimbal yapılabileceğinden
bahsetmiştim
(<a href=https://mozanunal.com/2015/06/2-eksenli-servo-gimbal-yapm/>O yazıya buradan ulaşabiliriniz</a>).
Kontrol kartını sonra anlatacağım demiştim. Veee bu yazımda arduino ve MPU6050
sensörü kullanarak nasıl bir gimbal kontrol kartı yapabileceğimizden
bahsedeceğim. Bu kart sayesinde gimbalin yere göre açısını kontrol edebileceğiz.
Yere göre açısının sabit kalmasını da kontrol kartı üzerindeki IMU sensörü ile
sağlayacağız(<a href=https://mozanunal.com/2014/11/imu-aclarnn-3-boyutlu-olarak/>Ayrıntılı bilgi için tıklayınız</a>).
Kontrol kartı saniyede 100 değer okuyup servo PWM değerlerini ona göre
güncelliyor. Bu sayede oldukça yüksek çözünürlüklü her türlü seviyede
kullanılabilecek bir kontrol kartı yapmış oluyoruz. Ayrıca başa koyduğum ayar
parametreleri sayesinde her boyutta ve çeşitte servo gimbale kolayca uyumlu hale
getirilebilir. Kontrol kartının tanıtım videosu aşağıdadır.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/MnfJcTREYPo?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>Bağlantılara gelecek olursak MPU6050 I2C pinlerinden arduinoya bağlanıyor. Gnd
pini gndye, Vcc pini ise 3.3 volta bağlanıyor. Çalışma voltajı 3.3 volt olduğu
için. Servoların sinyal pinlerini ayarlardan seçtiğimiz dijital pinlere
bağlıyoruz. Servoların beslemesi eğer küçük servolar ise arduino üzerinden eğer
yüksek akım çeken servolarsa harici olarak yapabilirsiniz. Fakat harici besleme
yaparsanız arduino ve güç kaynağının topraklarını eşitlemeyi unutmayın.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>////////////////////Ayarlar////////////////  
</span></span></span><span class=line><span class=cl><span class=c1>//pitch  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>p_pin</span><span class=o>=</span><span class=mi>8</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_neturalpos</span><span class=o>=</span><span class=mi>90</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_gain</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_min</span><span class=o>=</span><span class=mi>30</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_max</span><span class=o>=</span><span class=mi>150</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_reverse</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=c1>//roll  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>r_pin</span><span class=o>=</span><span class=mi>9</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_neturalpos</span><span class=o>=</span><span class=mi>90</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_gain</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_min</span><span class=o>=</span><span class=mi>30</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_max</span><span class=o>=</span><span class=mi>150</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_reverse</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>///////////////////////////////////////////////
</span></span></span></code></pre></div><p>Bunlar, koddaki ayar parametreleri, çeşitli gimballere kolay adapte edilebilmesi
içindir. İlk pozisyonunu, en düşük, en yüksek servo açılarını, kazancını bu
parametrelerle kontrol edeceğiz. Kazanç ise kontrol kartındaki açı
değişimlerinin servoya kaçla çarpılarak yansıtılacağının
parametresidir.&ldquo;Reverse&rdquo; değişkeni &ldquo;1&rdquo; veya &ldquo;0&rdquo; yapılarak yönün ters çevirilmesi
sağlanabilir. Benim gimbalim için &ldquo;Pitch&rdquo; eksenini ters yapmam gerekmişti.</p><p><strong>Sistemin Fotoğrafları</strong></p><p><img src=IMG_20150703_170713.jpg alt></p><p><img src=IMG_20150703_170813.jpg alt></p><p><strong>Projenin full kaynak kodu:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;I2Cdev.h&gt;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;MPU60X0.h&gt;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;EEPROM.h&gt;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;DebugUtils.h&#34;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;CommunicationUtils.h&#34;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;FreeIMU.h&#34;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;Wire.h&gt;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;SPI.h&gt;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;Servo.h&gt;</span><span class=cp>  
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>////////////////////Ayarlar////////////////  
</span></span></span><span class=line><span class=cl><span class=c1>//pitch  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>p_pin</span><span class=o>=</span><span class=mi>8</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_neturalpos</span><span class=o>=</span><span class=mi>90</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_gain</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_min</span><span class=o>=</span><span class=mi>30</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_max</span><span class=o>=</span><span class=mi>150</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_reverse</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=c1>//roll  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>r_pin</span><span class=o>=</span><span class=mi>9</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_neturalpos</span><span class=o>=</span><span class=mi>90</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_gain</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_min</span><span class=o>=</span><span class=mi>30</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_max</span><span class=o>=</span><span class=mi>150</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_reverse</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>///////////////////////////////////////////////  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Servo</span> <span class=n>pitchservo</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=n>Servo</span> <span class=n>rollservo</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>p_angle</span><span class=o>=</span><span class=mi>90</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>r_angle</span><span class=o>=</span><span class=mi>90</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>raw_values</span><span class=p>[</span><span class=mi>9</span><span class=p>];</span>  
</span></span><span class=line><span class=cl><span class=kt>float</span> <span class=n>ypr</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span> <span class=c1>// yaw pitch roll  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>float</span> <span class=n>val</span><span class=p>[</span><span class=mi>9</span><span class=p>];</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FreeIMU</span> <span class=n>my3IMU</span> <span class=o>=</span> <span class=n>FreeIMU</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=mi>115200</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>pitchservo</span><span class=p>.</span><span class=n>attach</span><span class=p>(</span><span class=n>p_pin</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>rollservo</span><span class=p>.</span><span class=n>attach</span><span class=p>(</span><span class=n>r_pin</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Wire</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>my3IMU</span><span class=p>.</span><span class=n>init</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>my3IMU</span><span class=p>.</span><span class=n>getYawPitchRoll</span><span class=p>(</span><span class=n>ypr</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;Yaw: &#34;</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>ypr</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34; Pitch: &#34;</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>ypr</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34; Roll: &#34;</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>ypr</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>  
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>p_angle</span><span class=o>=</span><span class=n>p_neturalpos</span><span class=o>+</span><span class=n>ypr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>p_gain</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>p_angle</span><span class=o>&gt;</span><span class=n>p_max</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>    <span class=n>p_angle</span><span class=o>=</span><span class=n>p_max</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>p_angle</span><span class=o>&lt;</span><span class=n>p_min</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>    <span class=n>p_angle</span><span class=o>=</span><span class=n>p_min</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>p_reverse</span><span class=o>=</span><span class=mi>1</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>    <span class=n>p_angle</span><span class=o>=</span><span class=mi>180</span><span class=o>-</span><span class=n>p_angle</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=n>pitchservo</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>p_angle</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>r_angle</span><span class=o>=</span><span class=n>r_neturalpos</span><span class=o>+</span><span class=n>ypr</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>*</span><span class=n>r_gain</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>r_angle</span><span class=o>&gt;</span><span class=n>r_max</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>    <span class=n>r_angle</span><span class=o>=</span><span class=n>r_max</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>r_angle</span><span class=o>&lt;</span><span class=n>r_min</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>    <span class=n>r_angle</span><span class=o>=</span><span class=n>r_min</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>r_reverse</span><span class=o>=</span><span class=mi>1</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>    <span class=n>r_angle</span><span class=o>=</span><span class=mi>180</span><span class=o>-</span><span class=n>r_angle</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=n>rollservo</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>r_angle</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div></article></main><footer><p>&copy; 2025 M.Ozan Unal.</p></footer></body><link rel=stylesheet href=/libs/katex/katex.min.v0.16.9.css><script defer src=/libs/katex/katex.min.v0.16.9.js></script><script defer src=/libs/katex/auto-render.v0.16.9.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-007KSW65JL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-007KSW65JL")}</script></html>