<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><link id=theme-style rel=stylesheet href=https://cdn.jsdelivr.net/gh/digitallytailored/classless@latest/classless.min.css><title>Yolo on Google Colab | mozanunal.com</title><link rel=icon href=/favicon.svg type=image/svg+xml><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body><header><div class=header-content><div class=theme-selector><select id=theme-selector-input><option value=https://cdn.jsdelivr.net/gh/digitallytailored/classless@latest/classless.min.css>Classless.css</option><option value=https://cdn.jsdelivr.net/gh/cspablocortez/cosmocss@latest/cosmo.min.css>Cosmo.css</option><option value=https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.classless.min.css>Pico</option><option value=https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.min.css>Pico-Fluid</option><option value=https://cdn.jsdelivr.net/npm/water.css@2/out/water.css>Water.css</option><option value=https://cdn.jsdelivr.net/npm/sakura.css/css/sakura.css>Sakura.css</option><option value=https://cdn.simplecss.org/simple.min.css>Simple.css</option><option value=https://cdn.jsdelivr.net/gh/alvaromontoro/almond.css@latest/dist/almond.min.css>Almond.css</option><option value=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css>New.css</option><option value=https://unpkg.com/missing.css>Missing.css</option><option value=https://unpkg.com/boltcss/bolt.min.css>Bolt.css</option><option value=https://perfectmotherfuckingwebsite.com/fuckingstyle.css>PerfectMFWS</option><option value>HTML only</option></select></div><script>(function(){"use strict";const o=document.getElementById("theme-style"),e=document.getElementById("theme-selector-input"),n="hugo-classless-theme";function s(t){o.href=t,e&&(e.value=t)}const t=localStorage.getItem(n);if(t){const n=Array.from(e.options).some(e=>e.value===t);n&&s(t)}e&&e.addEventListener("change",()=>{const t=e.value;s(t),localStorage.setItem(n,t)})})()</script><nav><h3>mozanunal.com</h3><h4><a href=/>Home</a> | <a href=/posts/>Posts</a> | <a href=/projects/>Projects</a> | <a href=/contact/>Contact</a></h4></nav></div></header><main><article><header><h1>Yolo on Google Colab</h1><p><em><time datetime=2019-08-13>August 13, 2019</time></em></p></header><div><h1 id=run-yolo-v3-on-colab-for-imagesvideos>Run YOLO V3 on Colab for images/videos</h1><p>Hello there, Today, we will be discussing how we can use the Darknet project on
Google Colab platform. For those who are not familiar with these terms:</p><p><img src=/images/yoloroad.gif alt="YOLO in action!"></p><ul><li>The Darknet project is an open-source project written in C, which is a
framework to develop deep neural networks.</li><li>Yolo V3 is an object detection algorithm. It is one of the state of the art
solution when <strong>accuracy/processing power needed</strong> metric is considered.</li><li>Google Cola is a cloud-based data science workspace similar to the jupyter
notebook. Each Collabrotary session is equipped with a virtual machine running
13 GB of ram and either a CPU, GPU, or TPU processor. In most case, all the
required packages are already installed on these machines and you can quite
easily start development using Google Collaboratory. It saves us from
installing process and it provides us <strong>easy to accessible GPU&rsquo;s</strong> which is
also <strong>free</strong> under some constraints.</li></ul><p>Have a look Ted Talk by Joseph Redmon the developer of the darknet project. The
talk is about Darknet and YOLO projects which titled as “How computers learn to
recognize objects instantly” . Darknet project aims to create a new neural
network framework which is completely focused on simplicity and performance. The
thing which I like about is its clarity and performance. All the code is written
in C, to define a deep learning network you should only create a config file
which defines the layers. By this way, it does not lose its performance
capabilities also it provides us easy to use interface for development with this
library.</p><p>Since I love both YOLO project and Google Colab, I decided to create a tutorial
to use them together. I create a GitHub repository and a Collaboratory notebook
for this purpose</p><ul><li><a href=https://colab.research.google.com/drive/1DcXQ_pLtLVvQAwILZR-kF0ZJwhkp11Jl>Colab Notebook</a></li><li><a href=https://github.com/mozanunal/yoloOnGoogleColab>mozanunal/yoloOnGoogleColab</a></li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/Cgxsv1riJhI?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p><strong>Please check</strong></p><ul><li><a href=https://pjreddie.com/darknet/yolo/>YOLO website</a></li><li><a href=https://pjreddie.com/darknet/>Darknet website</a></li><li><a href=https://arxiv.org/abs/1804.02767>YOLOV3 Paper</a></li></ul><h2 id=install>Install</h2><p>Go to the directory, clear and install everthing</p><ul><li>Clone the project</li><li>Change make file configurations and make OPENCV and GPU enable</li><li>Install opencv library</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>cv2</span><span style=color:#56b6c2>,</span> <span style=color:#e06c75>os</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>matplotlib.pyplot</span> <span style=color:#c678dd>as</span> <span style=color:#e06c75>plt</span>
</span></span><span style=display:flex><span><span style=color:#56b6c2>%</span><span style=color:#e06c75>matplotlib</span> <span style=color:#e06c75>inline</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!<span style=color:#e06c75>ls</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>cd</span> <span style=color:#56b6c2>/</span><span style=color:#e06c75>content</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>rm</span> <span style=color:#56b6c2>-</span><span style=color:#e06c75>fr</span> <span style=color:#e06c75>darknet</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>git</span> <span style=color:#e06c75>clone</span> <span style=color:#e06c75>https</span>:<span style=color:#56b6c2>//</span><span style=color:#e06c75>github</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>com</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>AlexeyAB</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>darknet</span><span style=color:#56b6c2>/</span>
</span></span><span style=display:flex><span><span style=color:#56b6c2>%</span> <span style=color:#e06c75>cd</span> <span style=color:#e06c75>darknet</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>sed</span> <span style=color:#56b6c2>-</span><span style=color:#e06c75>i</span> <span style=color:#98c379>&#39;s/OPENCV=0/OPENCV=1/g&#39;</span> <span style=color:#e06c75>Makefile</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>sed</span> <span style=color:#56b6c2>-</span><span style=color:#e06c75>i</span> <span style=color:#98c379>&#39;s/GPU=0/GPU=1/g&#39;</span> <span style=color:#e06c75>Makefile</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>sed</span> <span style=color:#56b6c2>-</span><span style=color:#e06c75>i</span> <span style=color:#98c379>&#39;s/CUDNN=0/CUDNN=1/g&#39;</span> <span style=color:#e06c75>Makefile</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>apt</span> <span style=color:#e06c75>update</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>apt</span><span style=color:#56b6c2>-</span><span style=color:#e06c75>get</span> <span style=color:#e06c75>install</span> <span style=color:#e06c75>libopencv</span><span style=color:#56b6c2>-</span><span style=color:#e06c75>dev</span>
</span></span></code></pre></div><h2 id=compile-and-configure>Compile and Configure</h2><ul><li>Compile YOLO</li><li>Download YOLO weights</li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!<span style=color:#e06c75>make</span> <span style=color:#56b6c2>&amp;&gt;</span> <span style=color:#e5c07b>compile</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>log</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!<span style=color:#e06c75>wget</span> <span style=color:#e06c75>https</span>:<span style=color:#56b6c2>//</span><span style=color:#e06c75>pjreddie</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>com</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>media</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>files</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>yolov3</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>weights</span>
</span></span></code></pre></div><pre><code>--2019-08-11 23:58:44--  https://pjreddie.com/media/files/yolov3.weights
Resolving pjreddie.com (pjreddie.com)... 128.208.4.108
Connecting to pjreddie.com (pjreddie.com)|128.208.4.108|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 248007048 (237M) [application/octet-stream]
Saving to: ‘yolov3.weights’

yolov3.weights      100%[===================&gt;] 236.52M  62.1MB/s    in 4.1s    

2019-08-11 23:58:48 (57.7 MB/s) - ‘yolov3.weights’ saved [248007048/248007048]
</code></pre><h2 id=test-an-image>Test An Image</h2><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>predictImage</span>(<span style=color:#e06c75>imageDir</span>):
</span></span><span style=display:flex><span>  <span style=color:#e06c75>os</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>system</span>(<span style=color:#98c379>&#34;cd /content/darknet &amp;&amp; ./darknet detect cfg/yolov3.cfg yolov3.weights </span><span style=color:#98c379>{}</span><span style=color:#98c379>&#34;</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>format</span>(<span style=color:#e06c75>imageDir</span>))
</span></span><span style=display:flex><span>  <span style=color:#e06c75>image</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>cv2</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>imread</span>(<span style=color:#98c379>&#34;/content/darknet/predictions.jpg&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#e06c75>height</span>, <span style=color:#e06c75>width</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>image</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>shape</span>[:<span style=color:#d19a66>2</span>]
</span></span><span style=display:flex><span>  <span style=color:#e06c75>resized_image</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>cv2</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>resize</span>(<span style=color:#e06c75>image</span>,(<span style=color:#d19a66>3</span><span style=color:#56b6c2>*</span><span style=color:#e06c75>width</span>, <span style=color:#d19a66>3</span><span style=color:#56b6c2>*</span><span style=color:#e06c75>height</span>), <span style=color:#e06c75>interpolation</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>cv2</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>INTER_CUBIC</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>fig</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>plt</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>gcf</span>()
</span></span><span style=display:flex><span>  <span style=color:#e06c75>fig</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>set_size_inches</span>(<span style=color:#d19a66>18</span>, <span style=color:#d19a66>10</span>)
</span></span><span style=display:flex><span>  <span style=color:#e06c75>plt</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>axis</span>(<span style=color:#98c379>&#34;off&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#7f848e>#plt.rcParams[&#39;figure.figsize&#39;] = [10, 5]</span>
</span></span><span style=display:flex><span>  <span style=color:#e06c75>plt</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>imshow</span>(<span style=color:#e06c75>cv2</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>cvtColor</span>(<span style=color:#e06c75>resized_image</span>, <span style=color:#e06c75>cv2</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>COLOR_BGR2RGB</span>))
</span></span><span style=display:flex><span>  <span style=color:#e06c75>plt</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>show</span>()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!<span style=color:#e06c75>wget</span> <span style=color:#e06c75>https</span>:<span style=color:#56b6c2>//</span><span style=color:#e06c75>github</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>com</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>mozanunal</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>yoloOnGoogleColab</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>raw</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>master</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>test</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>test</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>jpg</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>ls</span>
</span></span></code></pre></div><pre><code>--2019-08-11 23:58:49--  https://github.com/mozanunal/yoloOnGoogleColab/raw/master/test/test.jpg
Resolving github.com (github.com)... 192.30.253.113
Connecting to github.com (github.com)|192.30.253.113|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.jpg [following]
--2019-08-11 23:58:50--  https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.jpg
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 68535 (67K) [image/jpeg]
Saving to: ‘test.jpg’

test.jpg            100%[===================&gt;]  66.93K  --.-KB/s    in 0.05s   

2019-08-11 23:58:50 (1.32 MB/s) - ‘test.jpg’ saved [68535/68535]

3rdparty      CMakeLists.txt	      image_yolov3.sh	     results
appveyor.yml  compile.log	      include		     scripts
backup	      darknet		      json_mjpeg_streams.sh  src
build	      DarknetConfig.cmake.in  LICENSE		     test.jpg
build.ps1     darknet.py	      Makefile		     video_v2.sh
build.sh      darknet_video.py	      net_cam_v3.sh	     video_yolov3.sh
cfg	      data		      obj		     yolov3.weights
cmake	      image_yolov2.sh	      README.md
</code></pre><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e06c75>predictImage</span>(<span style=color:#98c379>&#34;test.jpg&#34;</span>)
</span></span></code></pre></div><p><img src=/images/output_11_0.png alt=png></p><h2 id=test-with-video>Test with Video</h2><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>predictVideo</span>(<span style=color:#e06c75>videoDir</span>):
</span></span><span style=display:flex><span>  <span style=color:#e06c75>os</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>system</span>(<span style=color:#98c379>&#34;&#34;&#34; cd /content/darknet &amp;&amp; ./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights </span><span style=color:#98c379>\
</span></span></span><span style=display:flex><span><span style=color:#98c379></span><span style=color:#98c379>  -dont_show </span><span style=color:#98c379>{}</span><span style=color:#98c379> -i 0 -out_filename res.avi
</span></span></span><span style=display:flex><span><span style=color:#98c379>  &#34;&#34;&#34;</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>format</span>(<span style=color:#e06c75>videoDir</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!<span style=color:#e06c75>wget</span> <span style=color:#e06c75>https</span>:<span style=color:#56b6c2>//</span><span style=color:#e06c75>github</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>com</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>mozanunal</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>yoloOnGoogleColab</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>raw</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>master</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>test</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>test</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>avi</span>
</span></span><span style=display:flex><span>!<span style=color:#e06c75>ls</span>
</span></span></code></pre></div><pre><code>--2019-08-11 23:59:01--  https://github.com/mozanunal/yoloOnGoogleColab/raw/master/test/test.avi
Resolving github.com (github.com)... 192.30.253.113
Connecting to github.com (github.com)|192.30.253.113|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.avi [following]
--2019-08-11 23:59:02--  https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.avi
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 15897530 (15M) [application/octet-stream]
Saving to: ‘test.avi’

test.avi            100%[===================&gt;]  15.16M  50.0MB/s    in 0.3s    

2019-08-11 23:59:02 (50.0 MB/s) - ‘test.avi’ saved [15897530/15897530]

3rdparty	compile.log		json_mjpeg_streams.sh  src
appveyor.yml	darknet			LICENSE		       test.avi
backup		DarknetConfig.cmake.in	Makefile	       test.jpg
build		darknet.py		net_cam_v3.sh	       video_v2.sh
build.ps1	darknet_video.py	obj		       video_yolov3.sh
build.sh	data			predictions.jpg        yolov3.weights
cfg		image_yolov2.sh		README.md
cmake		image_yolov3.sh		results
CMakeLists.txt	include			scripts
</code></pre><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e06c75>predictVideo</span>(<span style=color:#98c379>&#34;test.avi&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>!<span style=color:#e06c75>du</span> <span style=color:#56b6c2>-</span><span style=color:#e06c75>h</span> <span style=color:#e06c75>res</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>avi</span>
</span></span></code></pre></div><pre><code>93M	res.avi
</code></pre><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>from</span> <span style=color:#e06c75>google.colab</span> <span style=color:#c678dd>import</span> <span style=color:#e06c75>files</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>files</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>download</span>(<span style=color:#98c379>&#39;/content/darknet/res.avi&#39;</span>)
</span></span></code></pre></div><p><strong>See you later!</strong></p></div></article></main><footer><p>&copy; 2025 M.Ozan Unal.</p></footer></body><script async src="https://www.googletagmanager.com/gtag/js?id=G-007KSW65JL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-007KSW65JL")}</script></html>