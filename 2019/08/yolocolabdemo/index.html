<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=description content="An example site for the clean and configurable Hugo Classless theme."><link href=/2019/08/yolocolabdemo/ rel=alternate type=application/rss+xml title=mozanunal.com><link id=theme-style rel=stylesheet href=https://cdn.jsdelivr.net/gh/cspablocortez/cosmocss@latest/cosmo.min.css><style>pre code,code{-webkit-text-size-adjust:100%;text-size-adjust:100%}pre code.hljs{all:revert;display:block;font:.9rem/1.9 ui-monospace,SFMono-Regular,Menlo,monospace;overflow-x:auto}</style><title>Yolo on Google Colab | mozanunal.com</title><link rel=icon href=/favicon.svg type=image/svg+xml><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body><header><div class=theme-selector><select id=theme-selector-input><option value=https://cdn.jsdelivr.net/gh/cspablocortez/cosmocss@latest/cosmo.min.css>Cosmo.css</option><option value=https://cdn.jsdelivr.net/gh/digitallytailored/classless@latest/classless.min.css>Classless.css</option><option value=https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.classless.min.css>Pico</option><option value=https://cdn.jsdelivr.net/npm/water.css@2/out/water.css>Water.css</option><option value=https://cdn.simplecss.org/simple.min.css>Simple.css</option><option value=https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css>New.css</option><option value=https://unpkg.com/missing.css>Missing.css</option><option value=https://unpkg.com/boltcss/bolt.min.css>Bolt.css</option></select></div><script>(function(){"use strict";const o=document.getElementById("theme-style"),e=document.getElementById("theme-selector-input"),n="hugo-classless-theme";function s(t){o.href=t,e&&(e.value=t)}const t=localStorage.getItem(n);if(t){const n=Array.from(e.options).some(e=>e.value===t);n&&s(t)}e&&e.addEventListener("change",()=>{const t=e.value;s(t),localStorage.setItem(n,t)})})()</script><div><h1>mozanunal.com</h1><nav><p><a href=/>Home</a> | <a href=/posts/>Posts</a> | <a href=/projects/>Projects</a> | <a href=/papers/>Papers</a> | <a href=/contact/>Contact</a></p></nav></div></header><main><article><header><h1>Yolo on Google Colab</h1><p><em><time datetime=2019-08-13>August 13, 2019</time></em></p></header><div><h1 id=run-yolo-v3-on-colab-for-imagesvideos>Run YOLO V3 on Colab for images/videos</h1><p>Hello there, Today, we will be discussing how we can use the Darknet project on
Google Colab platform. For those who are not familiar with these terms:</p><p><img src=/images/yoloroad.gif alt="YOLO in action!"></p><ul><li>The Darknet project is an open-source project written in C, which is a
framework to develop deep neural networks.</li><li>Yolo V3 is an object detection algorithm. It is one of the state of the art
solution when <strong>accuracy/processing power needed</strong> metric is considered.</li><li>Google Cola is a cloud-based data science workspace similar to the jupyter
notebook. Each Collabrotary session is equipped with a virtual machine running
13 GB of ram and either a CPU, GPU, or TPU processor. In most case, all the
required packages are already installed on these machines and you can quite
easily start development using Google Collaboratory. It saves us from
installing process and it provides us <strong>easy to accessible GPU&rsquo;s</strong> which is
also <strong>free</strong> under some constraints.</li></ul><p>Have a look Ted Talk by Joseph Redmon the developer of the darknet project. The
talk is about Darknet and YOLO projects which titled as “How computers learn to
recognize objects instantly” . Darknet project aims to create a new neural
network framework which is completely focused on simplicity and performance. The
thing which I like about is its clarity and performance. All the code is written
in C, to define a deep learning network you should only create a config file
which defines the layers. By this way, it does not lose its performance
capabilities also it provides us easy to use interface for development with this
library.</p><p>Since I love both YOLO project and Google Colab, I decided to create a tutorial
to use them together. I create a GitHub repository and a Collaboratory notebook
for this purpose</p><ul><li><a href=https://colab.research.google.com/drive/1DcXQ_pLtLVvQAwILZR-kF0ZJwhkp11Jl>Colab Notebook</a></li><li><a href=https://github.com/mozanunal/yoloOnGoogleColab>mozanunal/yoloOnGoogleColab</a></li></ul><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/Cgxsv1riJhI?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p><strong>Please check</strong></p><ul><li><a href=https://pjreddie.com/darknet/yolo/>YOLO website</a></li><li><a href=https://pjreddie.com/darknet/>Darknet website</a></li><li><a href=https://arxiv.org/abs/1804.02767>YOLOV3 Paper</a></li></ul><h2 id=install>Install</h2><p>Go to the directory, clear and install everthing</p><ul><li>Clone the project</li><li>Change make file configurations and make OPENCV and GPU enable</li><li>Install opencv library</li></ul><pre><code class=language-python>import cv2, os
import matplotlib.pyplot as plt
%matplotlib inline
</code></pre><pre><code class=language-python>!ls
!cd /content
!rm -fr darknet
!git clone https://github.com/AlexeyAB/darknet/
% cd darknet
!sed -i 's/OPENCV=0/OPENCV=1/g' Makefile
!sed -i 's/GPU=0/GPU=1/g' Makefile
!sed -i 's/CUDNN=0/CUDNN=1/g' Makefile
!apt update
!apt-get install libopencv-dev
</code></pre><h2 id=compile-and-configure>Compile and Configure</h2><ul><li>Compile YOLO</li><li>Download YOLO weights</li></ul><pre><code class=language-python>!make &amp;&gt; compile.log
</code></pre><pre><code class=language-python>!wget https://pjreddie.com/media/files/yolov3.weights
</code></pre><pre><code>--2019-08-11 23:58:44--  https://pjreddie.com/media/files/yolov3.weights
Resolving pjreddie.com (pjreddie.com)... 128.208.4.108
Connecting to pjreddie.com (pjreddie.com)|128.208.4.108|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 248007048 (237M) [application/octet-stream]
Saving to: ‘yolov3.weights’

yolov3.weights      100%[===================&gt;] 236.52M  62.1MB/s    in 4.1s    

2019-08-11 23:58:48 (57.7 MB/s) - ‘yolov3.weights’ saved [248007048/248007048]
</code></pre><h2 id=test-an-image>Test An Image</h2><pre><code class=language-python>def predictImage(imageDir):
  os.system(&quot;cd /content/darknet &amp;&amp; ./darknet detect cfg/yolov3.cfg yolov3.weights {}&quot;.format(imageDir))
  image = cv2.imread(&quot;/content/darknet/predictions.jpg&quot;)
  height, width = image.shape[:2]
  resized_image = cv2.resize(image,(3*width, 3*height), interpolation = cv2.INTER_CUBIC)

  fig = plt.gcf()
  fig.set_size_inches(18, 10)
  plt.axis(&quot;off&quot;)
  #plt.rcParams['figure.figsize'] = [10, 5]
  plt.imshow(cv2.cvtColor(resized_image, cv2.COLOR_BGR2RGB))
  plt.show()
</code></pre><pre><code class=language-python>!wget https://github.com/mozanunal/yoloOnGoogleColab/raw/master/test/test.jpg
!ls
</code></pre><pre><code>--2019-08-11 23:58:49--  https://github.com/mozanunal/yoloOnGoogleColab/raw/master/test/test.jpg
Resolving github.com (github.com)... 192.30.253.113
Connecting to github.com (github.com)|192.30.253.113|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.jpg [following]
--2019-08-11 23:58:50--  https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.jpg
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 68535 (67K) [image/jpeg]
Saving to: ‘test.jpg’

test.jpg            100%[===================&gt;]  66.93K  --.-KB/s    in 0.05s   

2019-08-11 23:58:50 (1.32 MB/s) - ‘test.jpg’ saved [68535/68535]

3rdparty      CMakeLists.txt	      image_yolov3.sh	     results
appveyor.yml  compile.log	      include		     scripts
backup	      darknet		      json_mjpeg_streams.sh  src
build	      DarknetConfig.cmake.in  LICENSE		     test.jpg
build.ps1     darknet.py	      Makefile		     video_v2.sh
build.sh      darknet_video.py	      net_cam_v3.sh	     video_yolov3.sh
cfg	      data		      obj		     yolov3.weights
cmake	      image_yolov2.sh	      README.md
</code></pre><pre><code class=language-python>predictImage(&quot;test.jpg&quot;)
</code></pre><p><img src=/images/output_11_0.png alt=png></p><h2 id=test-with-video>Test with Video</h2><pre><code class=language-python>def predictVideo(videoDir):
  os.system(&quot;&quot;&quot; cd /content/darknet &amp;&amp; ./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights \
  -dont_show {} -i 0 -out_filename res.avi
  &quot;&quot;&quot;.format(videoDir))
</code></pre><pre><code class=language-python>!wget https://github.com/mozanunal/yoloOnGoogleColab/raw/master/test/test.avi
!ls
</code></pre><pre><code>--2019-08-11 23:59:01--  https://github.com/mozanunal/yoloOnGoogleColab/raw/master/test/test.avi
Resolving github.com (github.com)... 192.30.253.113
Connecting to github.com (github.com)|192.30.253.113|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.avi [following]
--2019-08-11 23:59:02--  https://raw.githubusercontent.com/mozanunal/yoloOnGoogleColab/master/test/test.avi
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 15897530 (15M) [application/octet-stream]
Saving to: ‘test.avi’

test.avi            100%[===================&gt;]  15.16M  50.0MB/s    in 0.3s    

2019-08-11 23:59:02 (50.0 MB/s) - ‘test.avi’ saved [15897530/15897530]

3rdparty	compile.log		json_mjpeg_streams.sh  src
appveyor.yml	darknet			LICENSE		       test.avi
backup		DarknetConfig.cmake.in	Makefile	       test.jpg
build		darknet.py		net_cam_v3.sh	       video_v2.sh
build.ps1	darknet_video.py	obj		       video_yolov3.sh
build.sh	data			predictions.jpg        yolov3.weights
cfg		image_yolov2.sh		README.md
cmake		image_yolov3.sh		results
CMakeLists.txt	include			scripts
</code></pre><pre><code class=language-python>predictVideo(&quot;test.avi&quot;)
</code></pre><pre><code class=language-python>!du -h res.avi
</code></pre><pre><code>93M	res.avi
</code></pre><pre><code class=language-python>from google.colab import files

files.download('/content/darknet/res.avi')
</code></pre><p><strong>See you later!</strong></p></div></article></main><footer><p>&copy; 2025 M.Ozan Unal.</p></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/highlight.js@11.11.0/styles/github.min.css media="(prefers-color-scheme: light)"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/highlight.js@11.11.0/styles/github-dark.min.css media="(prefers-color-scheme: dark)"><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js></script><script>hljs.highlightAll()</script></body><script async src="https://www.googletagmanager.com/gtag/js?id=G-007KSW65JL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-007KSW65JL")}</script></html>