<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=description content="An example site for the clean and configurable Hugo Classless theme."><link rel=canonical href=https://mozanunal.com/2019/11/ecg-signal/><link id=theme-style rel=stylesheet href=/css/classless.min.8cab153b82e5aafc291eef9470a782c75788db9fb12621ab48065a61682f0d2a.css integrity="sha256-jKsVO4LlqvwpHu+UcKeCx1eI25+xJiGrSAZaYWgvDSo="><link id=theme-style-dark rel=stylesheet href=/css/classless-dark.min.dfcff79e61518a7cd7fadd9ff9d784690eb5c3fc94e6d93e636ba054ec8e0ff1.css integrity="sha256-38/3nmFRinzX+t2f+deEaQ61w/yU5tk+Y2ugVOyOD/E=" media="(prefers-color-scheme: dark)"><style>#skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}#skip-link:focus{position:static;width:auto;height:auto;overflow:visible;padding:.5rem}pre code,code{-webkit-text-size-adjust:100%;text-size-adjust:100%}img{display:block;margin-left:auto;margin-right:auto}figcaption{display:block;margin-left:auto;margin-right:auto}header nav{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;overflow:visible;padding:.5rem 0;margin-bottom:1rem;font-size:1.25rem}header nav ul{display:flex;list-style:none;padding:0;margin:0;gap:0;align-items:center}header nav ul li+li::before{content:"|";padding:0 .4rem;opacity:.4}@media(max-width:600px){header nav{flex-direction:column;align-items:flex-start;gap:.5rem}}.dark-mode-toggle{background:0 0;border:none;cursor:pointer;padding:.25rem;margin:0;min-height:auto;min-width:auto;display:inline-flex;align-items:center;justify-content:center;color:var(--body-color);border-radius:var(--border-radius);transition:var(--transition-base);box-shadow:none;line-height:1}.dark-mode-toggle:hover{opacity:.7;box-shadow:none}.dark-mode-toggle:active{transform:none;box-shadow:none;filter:none}.dark-mode-toggle:hover::after{background-color:initial}.dark-mode-toggle svg{width:1.25rem;height:1.25rem;fill:currentColor}.dark-mode-toggle .icon-sun{display:none}.dark-mode-toggle .icon-moon{display:none}.dark-mode-toggle .icon-system{display:block}html[data-theme=light] .dark-mode-toggle .icon-sun{display:block}html[data-theme=light] .dark-mode-toggle .icon-moon{display:none}html[data-theme=light] .dark-mode-toggle .icon-system{display:none}html[data-theme=dark] .dark-mode-toggle .icon-sun{display:none}html[data-theme=dark] .dark-mode-toggle .icon-moon{display:block}html[data-theme=dark] .dark-mode-toggle .icon-system{display:none}</style><link id=syntax-light rel=stylesheet href=/css/syntax-light.min.d1e9974bf1fe0f3bfae6a7af3a04c1e749276b8efbbf6d3397998585f82443f0.css media="(prefers-color-scheme: light)"><link id=syntax-dark rel=stylesheet href=/css/syntax-dark.min.22964c63865be9217cedda7ac3dbd0143f8f41b3a0f681ef71e845b18a33a4f3.css media="(prefers-color-scheme: dark)"><title>Digital Filtering of an ECG Signal | mozanunal.com</title><link rel=icon href=/favicon.svg type=image/svg+xml><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon href=/apple-touch-icon.png><meta property="og:title" content="Digital Filtering of an ECG Signal"><meta property="og:description" content="An example site for the clean and configurable Hugo Classless theme."><meta property="og:type" content="article"><meta property="og:url" content="https://mozanunal.com/2019/11/ecg-signal/"><meta property="og:site_name" content="mozanunal.com"><meta property="article:published_time" content="2019-11-17T02:36:00Z"><meta property="article:modified_time" content="2019-11-17T02:36:00Z"><meta property="article:tag" content="ECG"><meta property="article:tag" content="Digital filtering for ECG"><meta property="article:tag" content="50 Hz filtering from ECG"><meta name=twitter:card content="summary"><meta name=twitter:title content="Digital Filtering of an ECG Signal"><meta name=twitter:description content="An example site for the clean and configurable Hugo Classless theme."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","author":{"@type":"Person","name":"M.Ozan Unal"},"dateModified":"2019-11-17T02:36:00Z","datePublished":"2019-11-17T02:36:00Z","description":"Hello everyone, Today, I will show how can you filter out the noise from the raw ECG signal. Let\u0026rsquo;s start!\nWhat is ECG? Electrocardiography (ECG) is the …","headline":"Digital Filtering of an ECG Signal"}</script></head><body><a id=skip-link href=#main-content>Skip to content</a><header><nav aria-label="Main navigation"><ul><li><strong>mozanunal.com</strong></li></ul><ul><li><a href=/>Home</a></li><li><a href=/posts/>Posts</a></li><li><a href=/projects/>Projects</a></li><li><a href=/papers/>Papers</a></li><li><button class=dark-mode-toggle id=dark-mode-toggle aria-label="Toggle color scheme" title="Toggle color scheme">
<svg class="icon-moon" viewBox="0 0 24 24" fill="currentColor"><path d="M21.752 15.002A9.718 9.718.0 0118 15.75c-5.385.0-9.75-4.365-9.75-9.75.0-1.33.266-2.597.748-3.752A9.753 9.753.0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753.0 009.002-5.998z"/></svg>
<svg class="icon-sun" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg>
<svg class="icon-system" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M2.25 5.25a3 3 0 013-3h13.5a3 3 0 013 3V15a3 3 0 01-3 3h-3v.75A.75.75.0 0115 19.5H9a.75.75.0 01-.75-.75V18h-3a3 3 0 01-3-3V5.25zm1.5.0a1.5 1.5.0 011.5-1.5h13.5a1.5 1.5.0 011.5 1.5V15a1.5 1.5.0 01-1.5 1.5H5.25A1.5 1.5.0 013.75 15V5.25z" clip-rule="evenodd"/></svg></button></li><script>(function(){var e,o,t="hugo-classless-color-scheme";function n(e,t,n,s){if(!e)return;t==="dark"?e.media=s:t==="light"?e.media=n:e.media=e.getAttribute("data-default-media")||""}function s(e){document.documentElement.setAttribute("data-theme",e);var t,s=document.getElementById("syntax-light"),o=document.getElementById("syntax-dark");n(s,e,"all","not all"),n(o,e,"not all","all"),t=document.getElementById("theme-style-dark"),n(t,e,"not all","all")}function i(){["syntax-light","syntax-dark","theme-style-dark"].forEach(function(e){var t=document.getElementById(e);t&&!t.getAttribute("data-default-media")&&t.setAttribute("data-default-media",t.media||"")})}e=null;try{e=localStorage.getItem(t)}catch{}o=e==="light"||e==="dark"?e:"system",document.documentElement.setAttribute("data-theme",o),document.addEventListener("DOMContentLoaded",function(){i(),s(o);var e=document.getElementById("dark-mode-toggle");if(!e)return;e.addEventListener("click",function(){var e,n=document.documentElement.getAttribute("data-theme");n==="light"?e="dark":n==="dark"?e="system":e="light",s(e);try{e==="system"?localStorage.removeItem(t):localStorage.setItem(t,e)}catch{}})}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){document.documentElement.getAttribute("data-theme")==="system"&&s("system")})})()</script></ul></nav></header><main id=main-content><article><p style=margin-bottom:0><a href=/>mozanunal.com</a>&nbsp;/&nbsp;<a href=https://mozanunal.com/posts/>Posts</a>&nbsp;/&nbsp;Digital Filtering of an ECG Signal</p><h1>Digital Filtering of an ECG Signal</h1><p><em><time datetime=2019-11-17>November 17, 2019</time>
&#183; 4 min read</em></p><div><p>Hello everyone, Today, I will show how can you filter out the noise from the raw
ECG signal. Let&rsquo;s start!</p><h3 id=what-is-ecg>What is ECG?</h3><p>Electrocardiography (ECG) is the measurement of the bioelectrical activity
during the contraction and relaxation stages of the atria and ventricles of the
heart, the stimulation of the heart and the conduction of the stimulus. ECG
signal has some specific waves which correspond to particular conditions.</p><p><strong>Part of the ECG Signal</strong> <img src=ekg15.jpg alt></p><h3 id=ecg-circuit>ECG Circuit</h3><p>During this process, a 9V battery was used as a source to prevent leakage
current through the person to whom the electrodes were connected and the sockets
to which the oscilloscopes were connected were checked. Also, in case of any
leakage, the person was allowed to separate his feet from the floor with the
help of the plastic chair he was sitting during the experiment and not to be in
physical contact with any person. The electrode attached to the right leg is
connected to the low-potential end (ground) of the battery as shown in the
figure above. The remaining two electrode terminals were connected to the
negative and positive input terminals on pins 2 and 3 of the INA118. A quite
simple circuit is created. It is shown in the next image. It basically consists
of 3 components: 2 x 9V battery, instrumentation amplifier INA118 with proper
connection and a gain resistor, and electrode connections. The circuit is not
the main focus of this post. For further information please send me an email. In
this post, I will focus on digital filters that can be used to filter out the
noise from the ECG signal.</p><p><strong>ECG Circuit Schematic</strong> <img src=ekgcircuit.png alt></p><h3 id=cleaning-noise>Cleaning Noise</h3><p><strong>Scope image of the output signal of the ECG circuit</strong> <img src=ekg14.jpg alt></p><p>The output of the circuit sampled using a digital oscilloscope and then it is
exported as CSV file. The file consists of 8000 samples for 2 seconds time
window which means 4 kHz sampling frequency. The raw oscilloscope output can be
examined from the next figure.</p><p><strong>Raw ECG Data</strong> <img src=ekg20.png alt></p><p>First, the frequency domain components of the ECG data are examined. FFT
transform is applied to data and its frequency components are plotted in the
next figure. Since the Nyquist theorem says that maximum frequency can be
measured is half of the sampling frequency, the max frequency component is 2
kHz.</p><p><strong>0 - 2 kHz Frequency Spectrum</strong> <img src=ekg4.png alt></p><p>In the next figure, the plot is zoomed to frequency components between 0 - 200
Hz. As you can see from the plot, there is a big noise component at 50 Hz
frequency because of the mains electricity. It should be filtered for a cleaner
ECG signal.</p><p><strong>0 - 200 Hz Frequency Spectrum</strong> <img src=ekg6.png alt></p><p>A digital IIR filter is designed to filter out a 50 Hz frequency component. It
is a Chebyshev Type 2 filter with 16 filter coefficients. It provides -60 dB
gain between 47 - 53 Hz.</p><p><strong>50 Hz Band Stop Filter</strong> <img src=ekg3.png alt></p><p>After the filtering, the frequency domain components are examined again. The
noise component at 50 Hz is removed from the signal.</p><p><strong>Frequency Domain Result</strong> <img src=ekg16.png alt></p><p>The time-domain result of the filter can be examined in the next figure. As you
can see from this figure, the time domain components of the ECG is cleaner.</p><p><strong>Time Domain Result</strong> <img src=ekg11.png alt></p><p>The next filter is designed to remove high-frequency noise from the signal. For
this purpose, a 0-200 Hz low pass filter is designed.</p><p><strong>0 - 200 Hz Low Pass Filter</strong> <img src=ekg7.png alt></p><p><strong>Time Domain Result</strong> <img src=ekg8.png alt></p><p>Finally, A simple moving average filter is applied to the signal. The next
figure is the final result of our ECG project. After the filtering operations,
most of the ECG components are cleaner and now it is easier to extract ECG
components from the signal.</p><p><strong>100 Point Simple Moving Average Filtered Signal</strong> <img src=ekg12.png alt></p><h3 id=test-it-yourself>Test it yourself</h3><p><a href=https://github.com/mozanunal/digital-filtering-of-ecg-signal>Click here to download the code and the ECG signal example</a></p></div><hr><p><strong>Tags:</strong><a href=https://mozanunal.com/tags/ecg/>ECG</a>, <a href=https://mozanunal.com/tags/digital-filtering-for-ecg/>Digital Filtering for ECG</a>, <a href=https://mozanunal.com/tags/50-hz-filtering-from-ecg/>50 Hz Filtering From ECG</a></p><p><strong>Categories:</strong><a href=https://mozanunal.com/categories/electronics/>Electronics</a></p><hr><h3>Related Posts</h3><ul><li><a href=https://mozanunal.com/2020/04/imaging-axis/>Medical Imaging Planes</a></li><li><a href=https://mozanunal.com/2020/02/micropython-mqtt-stream/>Micropython Mqtt Streamer</a></li><li><a href=https://mozanunal.com/2018/06/veriloga-giris/>[TR] Veriloga Giriş</a></li><li><a href=https://mozanunal.com/2018/04/google-docs-data-collection/>[TR] En Basit IOT Bulut Sistemi: Google Forms</a></li><li><a href=https://mozanunal.com/2018/03/micropython-1516117222475/>[TR] Micropython Nedir?</a></li></ul><hr><p><a href=https://mozanunal.com/2019/11/img2sh/>&larr; Show Images Directly on Terminal: img2sh</a> | <a href=https://mozanunal.com/2020/02/micropython-mqtt-stream/>Micropython Mqtt Streamer &rarr;</a></p></article></main><footer><p>&copy; 2026 M.Ozan Unal.</p></footer></body><link rel=stylesheet href=/libs/katex/katex.min.v0.16.9.css><script defer src=/libs/katex/katex.min.v0.16.9.js></script><script defer src=/libs/katex/auto-render.v0.16.9.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-007KSW65JL"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-007KSW65JL")}</script></html>